

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" sizes="16x16" href="../_static/favicon-16x16.png" type="image/png">
    <link rel="icon" sizes="32x32" href="../_static/favicon-32x32.png" type="image/png">
    <link rel="apple-touch-icon" sizes="180x180" href="../_static/apple-touch-icon.png" type="image/png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>cmlabs.integrate.simpsonq &mdash; cmlabs 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="cmlabs.integrate.simpsonc" href="cmlabs.integrate.simpsonc.html" />
    <link rel="prev" title="cmlabs.integrate.trapezoid" href="cmlabs.integrate.trapezoid.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            cmlabs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../cmlabs.interpolate.html">Interpolation (<code class="xref py py-mod docutils literal notranslate"><span class="pre">cmlabs.interpolate</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cmlabs.differentiate.html">Differentiation (<code class="xref py py-mod docutils literal notranslate"><span class="pre">cmlabs.differentiate</span></code>)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../cmlabs.integrate.html">Integration (<code class="xref py py-mod docutils literal notranslate"><span class="pre">cmlabs.integrate</span></code>)</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../cmlabs.integrate.html#integration">Integration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="cmlabs.integrate.rectangle.html">cmlabs.integrate.rectangle</a></li>
<li class="toctree-l3"><a class="reference internal" href="cmlabs.integrate.midpoint.html">cmlabs.integrate.midpoint</a></li>
<li class="toctree-l3"><a class="reference internal" href="cmlabs.integrate.trapezoid.html">cmlabs.integrate.trapezoid</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">cmlabs.integrate.simpsonq</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cmlabs.integrate.simpsonq"><code class="docutils literal notranslate"><span class="pre">simpsonq()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cmlabs.integrate.simpsonc.html">cmlabs.integrate.simpsonc</a></li>
<li class="toctree-l3"><a class="reference internal" href="cmlabs.integrate.weddles.html">cmlabs.integrate.weddles</a></li>
<li class="toctree-l3"><a class="reference internal" href="cmlabs.integrate.newton_cotes.html">cmlabs.integrate.newton_cotes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cmlabs.integrate.html#tests">Tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cmlabs.linalg.html">Linear Algebra (<code class="xref py py-mod docutils literal notranslate"><span class="pre">cmlabs.linalg</span></code>)</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">cmlabs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../cmlabs.integrate.html">Integration (<code class="xref py py-mod docutils literal notranslate"><span class="pre">cmlabs.integrate</span></code>)</a></li>
      <li class="breadcrumb-item active">cmlabs.integrate.simpsonq</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/cmlabs.integrate.simpsonq.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="cmlabs-integrate-simpsonq">
<h1>cmlabs.integrate.simpsonq<a class="headerlink" href="#cmlabs-integrate-simpsonq" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="cmlabs.integrate.simpsonq">
<span class="sig-prename descclassname"><span class="pre">cmlabs.integrate.</span></span><span class="sig-name descname"><span class="pre">simpsonq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yvals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cmlabs/integrate/_integrate.html#simpsonq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cmlabs.integrate.simpsonq" title="Link to this definition"></a></dt>
<dd><p>Composite Simpson’s 1/3 method using quadratic polynomial.</p>
<div class="math notranslate nohighlight">
\[\begin{gather}
    \int_{a}^{b} f(x) \, dx \approx \sum_{i=0}^{n-1}
    \frac{h}{3} \left[
    f(x_i) + 4f\left(\frac{x_i + x_{i+1}}{2}\right) + f(x_{i+1})\right]
\end{gather}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xvals</strong> (<em>array_like</em><em>, </em><em>1-D</em>) – The sorted x-coordinates of the data points.</p></li>
<li><p><strong>yvals</strong> (<em>array_like</em><em>, </em><em>1-D</em>) – The y-coordinates of the data points, i.e., <span class="math notranslate nohighlight">\(f(x)\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The approximate value of the integral.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Simpson’s 1/3 rule approximates the area under the curve by dividing it into
parabolas. The height of each parabola is determined by the function value
at the endpoints and the midpoint of the interval.</p>
<p>This method is fourth-order accurate. The error is approximately:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gather}
    R_{2,i}(f) = \int_{x_i}^{x_{i+1}} \left(f(x) - L_{2, i}(x) \right) dx
    = -\frac{h^5}{90}f^{(4)}(\xi_i) \\
    R_n(f) = \sum_{i=0}^{n-1} R_{2,i}(f) =
    \sum_{i=0}^{n-1} - \frac{h^5}{90}f^{(4)}(\xi_i),
    \quad \xi_i \in [x_i, x_{i+1}] \\
    R_n(f) = -\frac{h^5}{90} \cdot \frac{b-a}{2h} f^{(4)}(\xi) =
    -\frac{f(\xi)(b-a)}{180} h^4, \quad \xi \in [a, b] \\
    |R_n(f)| \leq \frac{M(b-a)}{180} h^4,
    \quad \max_{x \in [a, b]} |f^{(4)}(x)| \leq M
\end{gather}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(h\)</span> is the width of the rectangles and depends on the number of
intervals <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>The <span class="math notranslate nohighlight">\(\textit{xvals}\)</span> array is treated as</p>
<div class="math notranslate nohighlight">
\[[x_0, x_{\frac{1}{2}}, x_1, x_{\frac{3}{2}}, x_2, \ldots, x_{\frac{n}{2}}]\]</div>
<p>so <span class="math notranslate nohighlight">\(n\)</span> must be even. The same with the <span class="math notranslate nohighlight">\(\textit{yvals}\)</span> array.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># import numpy as np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># from cmlabs.integrate import simpsonq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># xvals = np.array([0, 1, 2, 3, 4])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># yvals = np.array([0, 1, 4, 9, 16])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simpsonq</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">yvals</span><span class="p">)</span>
<span class="go">21.333333333333332</span>
</pre></div>
</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cmlabs.integrate.trapezoid.html" class="btn btn-neutral float-left" title="cmlabs.integrate.trapezoid" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cmlabs.integrate.simpsonc.html" class="btn btn-neutral float-right" title="cmlabs.integrate.simpsonc" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Roman Sokolovsky.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>